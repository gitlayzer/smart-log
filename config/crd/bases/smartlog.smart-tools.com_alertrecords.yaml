---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  name: alertrecords.smartlog.smart-tools.com
spec:
  group: smartlog.smart-tools.com
  names:
    kind: AlertRecord
    listKind: AlertRecordList
    plural: alertrecords
    shortNames:
    - ar
    singular: alertrecord
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: The MonitorPod that triggered the alert
      jsonPath: .spec.monitorPodRef.name
      name: MonitorPod
      type: string
    - description: The rule that triggered the alert
      jsonPath: .spec.ruleName
      name: Rule
      type: string
    - description: The Pod that triggered the alert
      jsonPath: .spec.sourcePod.name
      name: Source Pod
      type: string
    - description: The time when the alert was triggered
      jsonPath: .spec.triggeredAt
      name: Triggered At
      type: date
    - description: The age of the AlertRecord
      jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: AlertRecord is the Schema for the alertrecords API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: spec defines the desired state of AlertRecord
            properties:
              logSnippet:
                description: LogSnippet 是匹配到的日志片段（可以是多行）。
                type: string
              monitorPodRef:
                description: MonitorPodRef 是触发此告警的 MonitorPod 的引用。
                properties:
                  name:
                    description: Name 是 MonitorPod 的名称。
                    type: string
                  namespace:
                    description: Namespace 是 MonitorPod 所在的命名空间。
                    type: string
                type: object
              ruleName:
                description: RuleName 是匹配到的规则的名称。
                type: string
              sourcePod:
                description: SourcePod 是产生日志的源头 Pod 的信息。
                properties:
                  container:
                    description: Container 是源 Pod 中触发告警的容器名称。
                    type: string
                  name:
                    description: Name 是源 Pod 的名称。
                    type: string
                  namespace:
                    description: Namespace 是源 Pod 所在的命名空间。
                    type: string
                type: object
              triggeredAt:
                description: TriggeredAt 是告警的精确触发时间。
                format: date-time
                type: string
            type: object
          status:
            description: status defines the observed state of AlertRecord
            properties:
              state:
                description: State 可以是 Firing, Ack, Resolved 等。
                type: string
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
